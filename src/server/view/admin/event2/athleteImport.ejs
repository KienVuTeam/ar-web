<style>
  .import-container {
    display: flex;
    justify-content: center;
  }
</style>

<!--  -->
<div class="container">
  <h2 class="mb-4">Upload Excel -> DB</h2>

  <form id="uploadForm" enctype="multipart/form-data">
    <div class="mb-3">
      <label for="excelFile" class="form-label">Ch·ªçn file Excel</label>
      <input
        type="file"
        name="file"
        id="excelFile"
        class="form-control"
        accept=".xls,.xlsx"
        required
      />
    </div>
    <button type="submit" id="btn-import" class="btn btn-primary">
      Upload
    </button>
  </form>

  <div id="result" class="mt-3"></div>
</div>
<!--  -->
<!-- <div class="import-container">
  <input type="file" name="" id="" />
  <button id="btn-import" class="btn btn-primary">Import Data</button>
</div> -->

<script>
    document.title ='Admin | <%=title%>';
  const btnImport = document.querySelector("#btn-import");
  // alert(btnImport)
//   console.log(btnImport);
  btnImport.addEventListener("click", function (el) {
    el.preventDefault();
    console.log(typeof el);
    console.log(el.target);
    let eventId = localStorage.getItem('currentEventId')
    alert(eventId)
    const file = document.getElementById('excelFile').files[0]
    handleSubmit(eventId, file);
  });

  async function handleSubmit(eventId, file){
    const formData = new FormData();
    formData.append('event_id', eventId)
    formData.append('file', file)

    var res = await fetch('/admin/event2/athlete/xlsx-upload', {
        method: "POST",
        body: formData
    });

    const resp =await res.json();
    console.log(resp)
    document.getElementById("result").innerHTML =`<pre>${JSON.stringify(resp.mess, null, 2)}</pre>`;
  }
//   async function test() {
//     e.preventDefault();
//     const formData = new FormData();
//     formData.append('event_id',eventId)
//     formData.append("file", document.getElementById("excelFile").files[0]);

//     const res = await fetch("/admin/event2/athlete/xlsx-upload", {
//       method: "POST",
//       body: formData,
//     });

//     const data = await res.json();
//     document.getElementById("result").innerHTML =
//       `<pre>${JSON.stringify(data, null, 2)}</pre>`;
//   }
</script>

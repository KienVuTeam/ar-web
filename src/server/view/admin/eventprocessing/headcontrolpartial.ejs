<style>
  .progress-container {
    position: relative;
  }

  .progressbar {
    display: flex;
    justify-content: space-between;
    position: relative;
    margin: 30px 0;
  }

  /* Line background */
  .progressbar::before {
    content: "";
    position: absolute;
    top: 32px;
    left: 0;
    width: 100%;
    height: 6px;
    background: #e0e0e0;
    border-radius: 4px;
    z-index: -1;
  }

  /* Line filled */
  .progress-line {
    content: "";
    position: absolute;
    top: 32px;
    left: 0;
    height: 6px;
    background: linear-gradient(90deg, #2196f3, #4caf50);
    border-radius: 4px;
    width: 0%;
    transition: width 0.4s ease;
    z-index: -1;
  }

  /* Step box */
  /* Step box */
.progress-step {
  background: #ddd;
  padding: 10px 15px;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 600;
  color: #555;
  text-align: center;
  min-width: 120px; /* nhỏ hơn một chút */
  max-width: 160px;
  word-wrap: break-word;   /* xuống dòng nếu text dài */
  white-space: normal;     /* cho phép xuống dòng */
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  transition: all 0.3s ease;
  cursor: pointer;
  flex: 1;                 /* tự giãn chia đều chiều ngang */
}

/* Khi màn hình nhỏ thì thu nhỏ box */
@media (max-width: 768px) {
  .progressbar {
    flex-direction: column;
    align-items: stretch;
    gap: 15px;
  }

  .progressbar::before,
  .progress-line {
    top: auto;
    left: 50%;
    transform: translateX(-50%);
    width: 6px;
    height: 100%;
  }

  .progress-line {
    transition: height 0.4s ease;
  }

  .progress-step {
    min-width: unset;
    max-width: 100%;
  }
}

  /* Active */
  .progress-step.active {
    background: linear-gradient(135deg, #2196f3, #42a5f5);
    color: #fff;
    transform: scale(1.05);
    box-shadow: 0 4px 10px rgba(33, 150, 243, 0.4);
  }

  /* Finish */
  .progress-step.finish {
    background: linear-gradient(135deg, #4caf50, #66bb6a);
    color: #fff;
    box-shadow: 0 4px 10px rgba(76, 175, 80, 0.4);
  }
</style>
<div class="progress-container">
  <div class="progressbar">
    <div class="progress-line" id="progress-line"></div>

    <div data-step="1" class="progress-step active">1. Initial</div>
    <div data-step="2" class="progress-step">2. Manage Athlete</div>
    <div data-step="3" class="progress-step">3. Send E-mail</div>
    <div data-step="4" class="progress-step">4. Check-in</div>
    <div data-step="5" class="progress-step">5. Finish</div>
  </div>
</div>

<script>
  // đưa ra global
  const steps = document.querySelectorAll(".progress-step");
    const progressLine = document.getElementById("progress-line");

    function updateProgress(currentStep = 0) {
      steps.forEach((step, idx) => {
        if (idx < currentStep) {
          step.classList.add("finish");
          step.classList.remove("active");
        } else if (idx === currentStep) {
          step.classList.add("active");
          step.classList.remove("finish");
        } else {
          step.classList.remove("active", "finish");
        }
      });

      let progressPercent = (currentStep / (steps.length - 1)) * 100;
      progressLine.style.width = progressPercent + "%";
    }
  document.addEventListener("DOMContentLoaded", function () {
    //write down
    

    // Auto demo (chạy từng step sau 1.5s)
    // setInterval(() => {
    //   currentStep = (currentStep + 1) % steps.length;
    //   updateProgress();
    // }, 1500);

    updateProgress(0);
    //
    document.querySelectorAll('.progressbar .progress-step').forEach((step, i)=>{
      step.addEventListener('click', function(ev){
        const el = ev.target;
        console.log(el)
        var _step = ev.currentTarget.getAttribute('data-step');
        const id = localStorage.getItem('_ei')
        console.log("inra id"+id)
        $.ajax({
          url: `/admin/eventprocessing/load-partial-view?ei=${id}&step=${_step}`,
          method: 'GET',
          // contentType: 'application/json',
          success: (res)=>{
            if(res.success){
              window.location.href = res.redirect;
            }
          },
          error: (err)=>{
            console.log("import athlete "+err);
            // alert("Loi get athlete");
          }
        })
      })
    })
  });
</script>
